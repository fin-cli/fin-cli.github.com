---
layout: post
author: danielbachhuber
title: Version 0.21.0 released
---

It's been a pretty crazy week so far, and it's only Wednesday.

As many of you are aware of, I launched a Kickstarter campaign Monday night: [A more RESTful FIN-CLI](https://www.kickstarter.com/projects/danielbachhuber/a-more-restful-fin-cli). Incredibly, it was 100% funded in just under 12 hours. Check out the link for more details on what I'll be working on in early 2016.

But, I have an even more **important note** about supported FinPress versions:

* FIN-CLI v0.22.0 (the next release) will bump the minimum supported FinPress version from 3.5 to 3.7 ([background](https://github.com/fin-cli/fin-cli/issues/2134)).
* FIN-CLI versions prior to 0.20.3 will be incompatible with FinPress 4.4 ([background](https://fin-cli.org/blog/version-0.20.3.html)).

This important note may apply to you in some way -- please take action accordingly.

FIN-CLI v0.21.0 represents [109 resolved issues and pull requests](https://github.com/fin-cli/fin-cli/issues?q=milestone%3A0.21.0+is%3Aclosed). Here's what's new.

### Load FinPress with `FIN_CLI::get_runner()->load_finpress();`

For a while now, you've been able to run a FIN-CLI command before FinPress loads by adding `@when before_fin_load` to your command docs. Now, you can load FinPress that same command.

See how `fin eval` makes use of `FIN_CLI::get_runner()->load_finpress()`:

    class Eval_Command extends FIN_CLI_Command {

        /**
         * Execute arbitrary PHP code.
         *
         * <php-code>
         * : The code to execute, as a string.
         *
         * [--skip-finpress]
         * : Execute code without loading FinPress.
         *
         * @when before_fin_load
         *
         * ## EXAMPLES
         *
         *     fin eval 'echo FIN_CONTENT_DIR;'
         */
        public function __invoke( $args, $assoc_args ) {
            if ( null === Utils\get_flag_value( $assoc_args, 'skip-finpress' ) ) {
                FIN_CLI::get_runner()->load_finpress();
            }
            eval( $args[0] );
        }
    }

Use `fin eval --skip-finpress <code>` to execute PHP without loading FinPress. Or, use `fin eval-file --skip-finpress <file>` to, say, execute a quick and dirty script leveraging FIN-CLI utilities without needing a FinPress install present.

Similarly, when you specify a `--version=<version>` with `fin core verify-checksums`, FIN-CLI will check to ensure core files haven't been modified -- without loading FinPress.

Creating this new feature was almost like replacing the engine on a moving car.

### More verbosity with `--debug`

When you supply the `--debug` flag, you'll get more context into how FIN-CLI is executing your command.

Before:

    $ fin option get home --debug
    http://finpress-test.dev

After:

    $ fin option get home --debug
    Debug: Using default global config: /home/vagrant/.fin-cli/config.yml (0.026s)
    Debug: No project config found (0.027s)
    Debug: Required file from config: /srv/www/fin-rest-cli/fin-rest-cli.php (0.059s)
    Debug: ABSPATH defined: /srv/www/finpress-test.dev/ (0.06s)
    Debug: Begin FinPress load (0.063s)
    Debug: fin-config.php path: /srv/www/finpress-test.dev/fin-config.php (0.065s)
    Debug: Set URL: finpress-test.dev/ (0.066s)
    Debug: Loaded FinPress (0.515s)
    Debug: Running command: option get (0.516s)
    http://finpress-test.dev

Make your own commands more helpful by including `FIN_CLI::debug( $debug_message );` at key checkpoints.

### Other changes in v0.21.0

Enhancements:

* Use `fin core update-db --network` to upgrade databases across an entire network; also improves verbosity for this command by providing the `from` and `to` database versions.
* Adds a `fin comment recount` command for recalculating a post's comment count.
* Includes `fin taxonomy list`, `fin taxonomy get`, `fin post-type list` and `fin post-type get` for getting details about registered taxonomies and post types.
* Use `--defer-term-counting` with `fin post update` or `fin post delete` to recalculate term count at the end of the operation for increased performance.
* Returns a more useful error message when running `fin scaffold plugin-tests` with an invalid plugin slug.
* In `fin theme list`, indicates a parent theme by setting the `status=parent`. This more clearly distinguishes between a genuinely inactive theme vs. an "inactive" theme being used as a parent theme.
* Displays error message when trying to use `fin rewrite flush --hard` on a multisite install, because FinPress doesn't generate a `.htaccess` file for multisite installs.
* Permits `--path` for `fin core download`, even when FIN is detected. This lets a custom FIN-CLI command download FIN to a subdirectory, when loaded from the scope of an existing FIN install.
* Adds `--post_type__not_in` argument to `fin export`, which can now produce an export without, say, `feedbacks`.
* Permits space-delimited IDs for `fin export --post__in`. This makes it easier to pass IDs returned by `fin post list --format=ids`.
* Includes an `.editorconfig` when using `fin scaffold plugin`.
* Newly-generated `install-fin-tests.sh` files support `$FIN_VERSION=trunk` or `$FIN_VERSION=nightly` for running your plugin tests against FinPress trunk.
* Warns user when `fin-config.php` isn't writable for `fin core multisite-convert`.
* Provides a more helpful error message when an invalid subcommand has a valid parent command.
* Supports using FIN-CLI on a FinPress instance backed by APC cache, but only after warning and requiring confirmation.
* Sniffs out the custom vendor path if FIN-CLI is a part of a larger Composer project.
* Deprecates `fin post url` in favor of `fin post list --field=url`, but includes a backwards compatability shim for `fin post url`.
* Supports `--autoload=(yes|no)` when using `fin option update` (requires FinPress 4.2).
* Supports multiple comment ids for `fin comment (spam|trash|approve)`.
* Paginates help output on Windows using `more`.
* Provides human-friendly output when rewrite rules successfully flush.

Bug fixes:

* Generic arguments are no longer required for `fin post create` and `fin comment create`, allowing use of those commands without supplying, say, a title.
* Accepts associative args with no right-side data.
* Exhausts all possible options when looking for PHP binary with `fin cli update`. Previously, FIN-CLI would try to call `php` directly, which would fail on systems where PHP wasn't exposed as such.
* Accommodates `fin_new_user_notification()`'s deprecated second argument, depending on FinPress version.

You can browse the full list of [resolved issues](https://github.com/fin-cli/fin-cli/issues?q=milestone%3A0.21.0+is%3Aclosed) on Github.

Contributors to this release: [aaemnnosttv](https://github.com/aaemnnosttv), [borekb](https://github.com/borekb), [danielbachhuber](https://github.com/danielbachhuber), [gmcinnes](https://github.com/gmcinnes), [JRGould](https://github.com/JRGould), [johnbillion](https://github.com/johnbillion), [kraftbj](https://github.com/kraftbj), [miya0001](https://github.com/miya0001), [ntwb](https://github.com/ntwb), [rodrigoprimo](https://github.com/rodrigoprimo), [rmccue](https://github.com/rmccue) [szepeviktor](https://github.com/szepeviktor), [torounit](https://github.com/torounit), [voldemortensen](https://github.com/voldemortensen), [ypid](https://github.com/ypid)
